#!/bin/env bash

set -e  # Exit on error

echo ""
echo "╔════════════════════════════════════════════════╗"
echo "║     Lean Scout Test Suite (Three Phases)       ║"
echo "╚════════════════════════════════════════════════╝"

echo ""
echo "=== Phase 0: Lean Schema Tests ==="
echo "Testing schema serialization/deserialization roundtrip"
lake test

echo ""
echo "=== Phase 1: Infrastructure Tests ==="
echo "Testing Python infrastructure without Lean data extraction"
uv run pytest test/internals/ -v

echo ""
echo "=== Phase 2: Data Extractor Tests ==="
echo "Testing data extractors using test_project"
uv run pytest test/extractors/ -v

echo ""
echo "╔════════════════════════════════════════════════╗"
echo "║          All Tests Passed! ✓                   ║"
echo "╚════════════════════════════════════════════════╝"
